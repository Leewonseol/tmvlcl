<!-- JavaScript ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>

<!-- JavaScript ì½”ë“œ ìˆ˜ì • ë¶€ë¶„ -->
<script>
    // ìš•êµ¬ íƒ€ì… ì •ì˜ì— ì„¤ëª… ì¶”ê°€
    const desireTypes = [
        { 
            key: 'destruction', 
            label: 'íŒŒê´´ ìš•êµ¬', 
            icon: 'ğŸ’¥', 
            color: '#dc3545',
            definition: 'ê³µê²©ì„±ê³¼ íŒŒê´´ì  ì¶©ë™'
        },
        { 
            key: 'connection', 
            label: 'ì—°ê²° ìš•êµ¬', 
            icon: 'â¤ï¸', 
            color: '#28a745',
            definition: 'ì• ì°©ê³¼ ì¹œë°€ê° ì¶”êµ¬'
        },
        { 
            key: 'escape', 
            label: 'íƒˆì¶œ ìš•êµ¬', 
            icon: 'ğŸƒ', 
            color: '#ffc107',
            definition: 'ìƒˆë¡œìš´ ê²½í—˜ê³¼ ë³€í™” ì¶”êµ¬'
        },
        { 
            key: 'power', 
            label: 'ê¶Œë ¥ ìš•êµ¬', 
            icon: 'ğŸ‘‘', 
            color: '#6f42c1',
            definition: 'ì§€ë°°ì™€ í†µì œ, ì˜í–¥ë ¥ í–‰ì‚¬ '
        },
        { 
            key: 'creation', 
            label: 'ì°½ì¡° ìš•êµ¬', 
            icon: 'ğŸ¨', 
            color: '#17a2b8',
            definition: 'ìƒˆë¡œìš´ ê²ƒ ì°½ì¡° ë° í‘œí˜„ ìš•êµ¬'
        },
        { 
            key: 'cognition', 
            label: 'ì¸ì§€ ìš•êµ¬', 
            icon: 'ğŸ§©', 
            color: '#fd7e14',
            definition: 'ì§€ì‹ ì¶”êµ¬ ë° ì´í•´ ìš•êµ¬'
        }
    ];

    // ì¸ë¬¼ ì¹´ë“œ ìƒì„± í•¨ìˆ˜ ìˆ˜ì •
    function createCharacterCard(character, index) {
        const cardDiv = document.createElement('div');
        cardDiv.className = 'col-md-6 col-lg-4';
        
        let desiresHtml = '';
        desireTypes.forEach(desire => {
            const value = character.desires[desire.key];
            desiresHtml += `
                <div class="desire-slider">
                    <label class="form-label">
                        <span data-bs-toggle="tooltip" 
                              data-bs-title="${desire.definition}"
                              style="cursor: help">
                            ${desire.icon} ${desire.label}
                        </span>
                        <span class="badge" style="background-color: ${desire.color}">${value.toFixed(2)}</span>
                    </label>
                    <input type="range" class="form-range" 
                           min="0" max="1" step="0.01" value="${value}"
                           onchange="updateCharacterDesire(${index}, '${desire.key}', this.value)">
                </div>
            `;
        });
        
        // ë‚˜ë¨¸ì§€ ì¹´ë“œ ë‚´ìš©ì€ ë™ì¼ ìœ ì§€
        cardDiv.innerHTML = `
            <div class="character-card">
                <h6>
                    <i class="fas fa-user"></i> ${character.name}
                    <button class="btn btn-sm btn-outline-light float-end" 
                            onclick="deleteCharacter(${index})">
                        <i class="fas fa-trash"></i>
                    </button>
                </h6>
                ${desiresHtml}
                <hr>
                <small>
                    <strong>íŠ¹ì„±:</strong><br>
                    ì •ì‹ : ${character.traits.mental.toFixed(2)} | 
                    ì‚¬íšŒ: ${character.traits.social.toFixed(2)} | 
                    ë…¸ë ¥: ${character.effort.toFixed(2)}
                </small>
            </div>
        `;
        
        return cardDiv;
    }

    // íˆ´íŒ ì´ˆê¸°í™” ì½”ë“œ ì¶”ê°€
    function updateCharacterDisplay() {
        const container = document.getElementById('charactersContainer');
        container.innerHTML = '';
        
        characters.forEach((character, index) => {
            const card = createCharacterCard(character, index);
            container.appendChild(card);
        });

        // íˆ´íŒ ì´ˆê¸°í™”
        var tooltipTriggerList = [].slice.call(container.querySelectorAll('[data-bs-toggle="tooltip"]'));
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl, {
                trigger: 'hover'
            });
        });
    }
</script>
